import{r as l,j as e,L as F,S as L}from"./index-B98PupNe.js";import{u as g,L as b,f as D,b as q,a as C}from"./api-CaqdZfy5.js";import{S as E,P as O,a as A}from"./PredictionCard-DVVKp0kX.js";import"./LineChart-DLf5VVJj.js";import"./trending-down-DLbKuMNo.js";const Y=()=>{const[r,c]=l.useState([]),[s,d]=l.useState(""),[x,j]=l.useState(""),{data:n,isLoading:N}=g({queryKey:["companies"],queryFn:D});l.useEffect(()=>{const t=localStorage.getItem("favorites"),a=t?JSON.parse(t):[];c(Array.isArray(a)?a:[]);const o=new Date;o.setDate(o.getDate()+1),j(o.toISOString().split("T")[0])},[]);const p=l.useMemo(()=>n?n.filter(t=>r.includes(t.ticker)):[],[n,r]),i=n==null?void 0:n.find(t=>t.ticker===s),S=t=>{if(!t)return;const a=new Set(r),o=a.has(t);o?a.delete(t):a.add(t);const y=Array.from(a);localStorage.setItem("favorites",JSON.stringify(y)),c(y),o&&s===t&&d("")},m=new Date(x),h=m.getFullYear(),u=m.getMonth()+1,f=m.getDate(),{data:v,isLoading:w,error:k}=g({queryKey:["prediction",s,h,u,f],queryFn:()=>q(s,h,u,f),enabled:!!s});return N?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(b,{})}):e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8 space-y-8",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Favorites"}),e.jsx(F,{to:"/dashboard",className:"text-blue-600 text-sm",children:"Back to Dashboard"})]}),r.length===0?e.jsx("div",{className:"bg-white p-6 rounded-xl text-center border",children:e.jsx("p",{children:"No favorites yet."})}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2 bg-white p-6 rounded-xl border",children:s?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between mb-4",children:[e.jsx("div",{children:e.jsxs("h2",{className:"font-semibold text-lg",children:[i==null?void 0:i.name," ",e.jsxs("span",{className:"text-gray-500",children:["(",i==null?void 0:i.ticker,")"]})]})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("input",{type:"date",value:x,onChange:t=>j(t.target.value),className:"border rounded-lg p-2 text-sm"}),e.jsx("button",{onClick:()=>s&&S(s),children:r.includes(s)?e.jsx(L,{className:"text-yellow-500"}):e.jsx(E,{})})]})]}),e.jsx(I,{selectedTicker:s,prediction:v}),i&&e.jsx("div",{className:"mt-6",children:e.jsx(O,{company:i,year:h,month:u,day:f,prediction:v,isLoading:w,error:k})})]}):e.jsx("div",{className:"h-64 flex items-center justify-center text-gray-600",children:"Click a favorite on the right to view chart & prediction."})}),e.jsxs("aside",{className:"bg-white p-6 rounded-xl border self-start h-fit max-h-[70vh] overflow-y-auto",children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Your Favorites"}),e.jsx("div",{className:"space-y-3",children:p.length===0?e.jsx("p",{className:"text-sm text-gray-500",children:"No favorites added"}):p.map(t=>e.jsxs("button",{onClick:()=>d(a=>a===t.ticker?"":t.ticker),"aria-pressed":s===t.ticker,className:`w-full text-left p-3 rounded-lg border transition ${s===t.ticker?"bg-blue-50 border-blue-500":"hover:bg-gray-50"}`,children:[e.jsx("p",{className:"font-semibold",children:t.ticker}),e.jsx("p",{className:"text-sm text-gray-600",children:t.name})]},t.ticker))})]})]})]})},I=({selectedTicker:r,prediction:c})=>{const{data:s,isLoading:d,error:x}=g({queryKey:["historical",r],queryFn:()=>C(r),enabled:!!r});return d?e.jsx(b,{}):x?e.jsx("p",{children:"Error loading chart"}):e.jsx(A,{data:s??[],prediction:c})};export{Y as default};
