import{r as o,j as e,L as D}from"./index-B98PupNe.js";import{u as g,L as P,f as w,b as S}from"./api-CaqdZfy5.js";const h=60,T=()=>{const{data:a,isLoading:u}=g({queryKey:["companies"],queryFn:w}),x=new Date,n=x.toISOString().split("T")[0],d=new Date(x);d.setDate(d.getDate()+1);const p=d.toISOString().split("T")[0],[r,j]=o.useState(p),{year:y,month:N,day:v}=o.useMemo(()=>{const t=new Date(r+"T00:00:00");return{year:t.getFullYear(),month:t.getMonth()+1,day:t.getDate()}},[r]),{data:l,isLoading:f}=g({queryKey:["recognize",r],queryFn:async()=>{if(!a||a.length===0)return[];const t=a.slice(0,h);return(await Promise.all(t.map(async c=>{try{const i=await S(c.ticker,y,N,v);return{company:c,prediction:i}}catch{return null}}))).filter(Boolean)},enabled:!!a}),m=o.useMemo(()=>l?l.slice().sort((t,s)=>s.prediction.predictedPrice-t.prediction.predictedPrice):[],[l]);return u||f?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(P,{})}):e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Top Predicted Prices"}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx(D,{to:"/dashboard",className:"text-sm text-blue-600",children:"Back"})})]}),e.jsxs("div",{className:"bg-white p-4 rounded-xl border",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 items-end mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Prediction Date"}),e.jsx("input",{type:"date",value:r,min:n,onChange:t=>j(t.target.value>=n?t.target.value:n),className:"w-full border p-2 rounded"})]}),e.jsxs("div",{className:"sm:col-span-2 text-sm text-gray-500 flex items-center",children:["Showing top results by predicted price (descending). Data limited to ",h," candidates for performance."]})]}),m.length===0?e.jsx("div",{className:"py-8 text-center text-gray-500",children:"No predictions available"}):e.jsx("div",{className:"divide-y",children:m.map(({company:t,prediction:s},c)=>{const i=s.predictedPrice-s.currentPrice,b=i/s.currentPrice*100;return e.jsxs("div",{className:"py-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"w-10 text-lg font-bold text-gray-700",children:["#",c+1]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-semibold",children:[t.ticker," ",e.jsxs("span",{className:"text-xs text-gray-500",children:["— ",t.name]})]}),e.jsxs("div",{className:"text-xs text-gray-400",children:["As of: ",s.createdAt.split("T")[0]]})]})]}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Current"}),e.jsxs("div",{className:"text-lg font-semibold",children:["₹",s.currentPrice.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Predicted"}),e.jsxs("div",{className:"text-lg font-semibold text-indigo-600",children:["₹",s.predictedPrice.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("div",{className:"text-right w-36",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Change"}),e.jsxs("div",{className:`text-lg font-semibold ${i>=0?"text-green-600":"text-red-600"}`,children:[i>=0?"+":"",b.toFixed(2),"%"]})]})]})]},t.ticker)})})]})]})};export{T as default};
