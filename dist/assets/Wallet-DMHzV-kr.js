import{c as f,r as o,j as e,W as w,L as T,T as C}from"./index-B98PupNe.js";import{u as I,L as A,a as D,f as $}from"./api-CaqdZfy5.js";import{D as V}from"./dollar-sign-f3cNXzcp.js";import{T as E}from"./trending-down-DLbKuMNo.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=f("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=f("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=f("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=f("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=f("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),m=r=>`₹${r.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}`,U=()=>{const[r,p]=o.useState([]),[c,j]=o.useState(""),[u,N]=o.useState(1),[y,b]=o.useState(0),{data:d,isLoading:k}=I({queryKey:["companies"],queryFn:$});o.useEffect(()=>{const t=localStorage.getItem("wallet");if(t)try{const s=JSON.parse(t);p(Array.isArray(s)?s:[])}catch{p([])}},[]),o.useMemo(()=>r.map(t=>({...t,currentPrice:0,loading:!0})),[r]);const v=o.useMemo(()=>[...new Set(r.map(t=>t.ticker))],[r]);o.useMemo(()=>{const t={};return v.forEach(s=>{t[s]={data:void 0,isLoading:!0}}),t},[v]);const[g,S]=o.useState({});o.useEffect(()=>{const t=async()=>{const s={};for(const i of r)try{const l=await D(i.ticker);l&&l.length>0?s[i.ticker]=l[l.length-1].price:s[i.ticker]=i.buyPrice}catch{s[i.ticker]=i.buyPrice}S(s)};r.length>0&&t()},[r]);const a=o.useMemo(()=>{let t=0,s=0;r.forEach(n=>{const h=n.quantity,x=n.buyPrice,M=g[n.ticker]||x;t+=h*x,s+=h*M});const i=s-t,l=t>0?i/t*100:0;return{totalInvested:t,totalCurrentValue:s,totalProfitLoss:i,returns:l}},[r,g]);d==null||d.find(t=>t.ticker===c),o.useEffect(()=>{c&&g[c]&&b(g[c])},[c,g]);const L=()=>{if(!c||!u||!y||u<=0||y<=0)return;const t=d==null?void 0:d.find(n=>n.ticker===c);if(!t)return;const s={ticker:c,name:t.name,quantity:Number(u),buyPrice:Number(y),buyDate:new Date().toISOString().split("T")[0]},i=r.findIndex(n=>n.ticker===c);let l;if(i>=0){l=[...r];const n=l[i],h=n.quantity+s.quantity,x=n.quantity*n.buyPrice+s.quantity*s.buyPrice;l[i]={...n,quantity:h,buyPrice:x/h}}else l=[...r,s];p(l),localStorage.setItem("wallet",JSON.stringify(l)),j(""),N(1),b("")},q=t=>{const s=r.filter(i=>i.ticker!==t);p(s),localStorage.setItem("wallet",JSON.stringify(s))};return k?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(A,{})}):e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8 space-y-8",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-gradient-to-r from-primary-600 to-accent-600 rounded-xl",children:e.jsx(w,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"My Wallet"}),e.jsx("p",{className:"text-gray-600",children:"Track your stock portfolio"})]})]}),e.jsx(T,{to:"/dashboard",className:"text-blue-600 text-sm hover:underline",children:"Back to Dashboard"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl border shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Current Value"}),e.jsx(V,{className:"h-5 w-5 text-blue-600"})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:m(a.totalCurrentValue)}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Total portfolio value"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Invested Amount"}),e.jsx(F,{className:"h-5 w-5 text-purple-600"})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:m(a.totalInvested)}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Total amount invested"})]}),e.jsxs("div",{className:`p-6 rounded-xl border shadow-sm ${a.totalProfitLoss>=0?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:`text-sm ${a.totalProfitLoss>=0?"text-green-700":"text-red-700"}`,children:"Profit / Loss"}),a.totalProfitLoss>=0?e.jsx(B,{className:"h-5 w-5 text-green-600"}):e.jsx(R,{className:"h-5 w-5 text-red-600"})]}),e.jsxs("p",{className:`text-2xl font-bold ${a.totalProfitLoss>=0?"text-green-700":"text-red-700"}`,children:[a.totalProfitLoss>=0?"+":"",m(a.totalProfitLoss)]}),e.jsx("p",{className:`text-xs ${a.totalProfitLoss>=0?"text-green-600":"text-red-600"} mt-1`,children:m(a.totalProfitLoss)})]}),e.jsxs("div",{className:`p-6 rounded-xl border shadow-sm ${a.returns>=0?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:`text-sm ${a.returns>=0?"text-green-700":"text-red-700"}`,children:"Returns"}),a.returns>=0?e.jsx(C,{className:"h-5 w-5 text-green-600"}):e.jsx(E,{className:"h-5 w-5 text-red-600"})]}),e.jsxs("p",{className:`text-2xl font-bold ${a.returns>=0?"text-green-700":"text-red-700"}`,children:[a.returns>=0?"+":"",a.returns.toFixed(2),"%"]}),e.jsx("p",{className:`text-xs ${a.returns>=0?"text-green-600":"text-red-600"} mt-1`,children:a.returns>=0?"Profit":"Loss"})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border shadow-sm",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[e.jsx(P,{className:"h-5 w-5 mr-2 text-primary-600"}),"Add Stock to Portfolio"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Select Stock"}),e.jsxs("select",{value:c,onChange:t=>j(t.target.value),className:"w-full border rounded-lg p-3 focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Select a stock"}),d==null?void 0:d.map(t=>e.jsxs("option",{value:t.ticker,children:[t.ticker," - ",t.name]},t.ticker))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Quantity"}),e.jsx("input",{type:"number",value:u,onChange:t=>N(t.target.value===""?"":Number(t.target.value)),min:1,className:"w-full border rounded-lg p-3 focus:ring-2 focus:ring-blue-500",placeholder:"1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Buy Price (₹)"}),e.jsx("input",{type:"number",value:y,onChange:t=>b(t.target.value===""?"":Number(t.target.value)),min:.01,step:.01,className:"w-full border rounded-lg p-3 focus:ring-2 focus:ring-blue-500",placeholder:"0.00"})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("button",{onClick:L,disabled:!c||!u||!y||u<=0||y<=0,className:"w-full bg-gradient-to-r from-primary-600 to-accent-600 text-white py-3 px-4 rounded-lg font-semibold hover:from-primary-500 hover:to-accent-500 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:[e.jsx(P,{className:"h-5 w-5 mr-2"}),"Add to Portfolio"]})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Your Holdings"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[r.length," stocks in your portfolio"]})]}),r.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(w,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No stocks in your portfolio"}),e.jsx("p",{className:"text-gray-600",children:"Add stocks above to start tracking your investments"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-600",children:"Stock"}),e.jsx("th",{className:"px-6 py-4 text-right text-sm font-semibold text-gray-600",children:"Qty"}),e.jsx("th",{className:"px-6 py-4 text-right text-sm font-semibold text-gray-600",children:"Buy Price"}),e.jsx("th",{className:"px-6 py-4 text-right text-sm font-semibold text-gray-600",children:"Current Price"}),e.jsx("th",{className:"px-6 py-4 text-right text-sm font-semibold text-gray-600",children:"Total Value"}),e.jsx("th",{className:"px-6 py-4 text-right text-sm font-semibold text-gray-600",children:"P&L"}),e.jsx("th",{className:"px-6 py-4 text-center text-sm font-semibold text-gray-600",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:r.map(t=>{const s=g[t.ticker]||t.buyPrice,i=t.quantity*s,l=t.quantity*t.buyPrice,n=i-l,h=l>0?n/l*100:0,x=n>=0;return e.jsxs("tr",{className:"hover:bg-gray-50 transition",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:t.ticker}),e.jsx("p",{className:"text-sm text-gray-600",children:t.name})]})}),e.jsx("td",{className:"px-6 py-4 text-right font-medium",children:t.quantity}),e.jsx("td",{className:"px-6 py-4 text-right",children:m(t.buyPrice)}),e.jsx("td",{className:"px-6 py-4 text-right font-medium",children:m(s)}),e.jsx("td",{className:"px-6 py-4 text-right font-semibold",children:m(i)}),e.jsxs("td",{className:"px-6 py-4 text-right",children:[e.jsxs("div",{className:`font-semibold ${x?"text-green-600":"text-red-600"}`,children:[x?"+":"",m(n)]}),e.jsxs("div",{className:`text-xs ${x?"text-green-500":"text-red-500"}`,children:[x?"+":"",h.toFixed(2),"%"]})]}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("button",{onClick:()=>q(t.ticker),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition",title:"Remove from portfolio",children:e.jsx(H,{className:"h-5 w-5"})})})]},t.ticker)})})]})})]})]})};export{U as default};
